## Просмотр модулей

В Java 9 были добавлены опции командной строки для просмотра и описания модулей
и их внутренностей. Опции предусмотрены для команд **java, jar.**

## Опции для команды java

### Описание модуля

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
java -p mods -d ru.example.testmodules // название модуля
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

или

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
java -p mods --describe-module ru.example.testmodules // название модуля
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

команды выводят информацию о модулях, например:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
$ java -p mods -d ru.example.testmodules 
ru.example.testmodules file:///E:/blog/code_examples/mods/ru.example.testmodules.jar
exports ru.example.testmodules requires java.base mandated
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**java.base** - специальный модуль, он автоматически добавляется как зависимость
ко всем модулям без исключения.

### Перечисление доступных модулей

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
java --list-modules 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

перечисляет стандартные модули java модули Всего в поставке из около 70

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
java -p mods --list-modules 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

перечисляет стандартные модули java модули, и модули в папке mods

### Максимально подробное описание

В команду запуска (см. команда запуска) добавить аргумент
\-–show-module-resolution

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
java \
        --module-path mods \
        --show-module-resolution \
        --module ru.example.testmodules \
         ru.example.testmodules.CommonJob
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для анализа вывода этой команды нужна еще одна статься TODO.

## Опции для команды jar

### Описание модуля:

`jar -f mods/ru.example.testmodules.jar –d `

`jar --file mods/ru.example.testmodules.jar --describe-module`

вывод

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
ru.example.testmodules jar:file:///E:/blog/code_examples/mods/ru.example.testmodules.jar/!module-info.class
exports ru.example.testmodules
requires java.base mandated
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

## Команда jdeps

Дает инфо о зависимостях внутри модуля. Утилита смотрит в код, поэтому сообщает
о том, какие зависимости реально используются, а не просто задекларированы.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
jdeps -s mods/ru.example.testmodules.jar 
jdeps -summary mods/ru.example.testmodules.jar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Если не использовать –summary/ -s то описание будет более подробно (какие пакеты
используются в каком модуле).

Если в модуле используются не только стандартные модули – то нужно указывать к
ним путь, с помощью опции **--module-path**, для jdeps краткой формы этой опции
не существует.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
jdeps \
--module-path mods \
mods/ru.example.users.jar
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

## Команда jmod

JMOD – файл это файл java – модуля. Есть рекомендация для файлов java-модулей
использовать jar – файлы, и только если используются нативные библиотеки (dll
или so) – использовать JMOD – файлы.

Режимы работы:

| **Операция** | **Описание**                                    |
|--------------|-------------------------------------------------|
| create       | Создание JMOD – файла                           |
| extract      | Работает как unzip                              |
| describe     | Печатает всякие подробности, такие как requires |
| list         | Печатает все файлы изнутря JMOD – файла         |
| hash         | Печатает hash                                   |

Таблица некоторых полезных команд:

| **Описание**                          | **Синтаксис**                                                                                                                   |
|---------------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
| Компиляция не модульного кода         | javac -cp classpath -d directory classesToCompile                                                                               |
| Запуск не модульного кода             | java -cp classpath package.className                                                                                            |
|                                       | -cp == -classpath == --class-path                                                                                               |
| Компиляция модуля                     | jvac --module-path moduleFolderName -d directory classesToCompileIncludingModuleInfo                                            |
|                                       | --module-path == -p                                                                                                             |
| Запуск модуля                         | java --module-path moduleFolderName --module moduleName/package.className                                                       |
|                                       | --module-path == -p --module == -m                                                                                              |
| Описание модуля                       | java --module-path moduleFolderName moduleName  jar--describe-module --file jarName --describe-module                           |
|                                       | --module-path == -p --describe-module == -d --file == -f                                                                        |
| Перечислить доступные модули          | java --list-modules java --module-path moduleFolderName --list-modules                                                          |
|                                       | --module-path == -p                                                                                                             |
| Посмотреть зависимости                | jdeps -summary --module-path moduleFolderName jarName                                                                           |
|                                       | -summary == -s --module-path != -p (нельзя)                                                                                     |
| Подробное описание модуля при запуске | java \         --module-path mods \         --show-module-resolution \         --module module.name \          full.class.Name  |
|                                       | --module-path == -p --module == -m                                                                                              |
